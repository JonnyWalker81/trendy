---
phase: 03-geofence-reliability
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/ios/trendy/Views/Geofence/GeofenceDebugView.swift
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Registered Regions section displays latitude and longitude for each region"
    - "Registered Regions section displays radius for each region"
  artifacts:
    - path: "apps/ios/trendy/Views/Geofence/GeofenceDebugView.swift"
      provides: "Coordinate display in Registered Regions section"
      contains: "CLCircularRegion"
  key_links:
    - from: "GeofenceDebugView"
      to: "monitoredRegions"
      via: "direct access to CLRegion set"
      pattern: "monitoredRegions"
---

<objective>
Add coordinate display to the Registered Regions section in GeofenceDebugView

Purpose: Close UAT gap - user expects to see region coordinates (lat/long) and radius alongside region identifiers for debugging purposes.

Output: Updated GeofenceDebugView.swift with coordinates displayed for each registered region.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-geofence-reliability/03-UAT.md

# Current implementation
@apps/ios/trendy/Views/Geofence/GeofenceDebugView.swift
@apps/ios/trendy/Services/GeofenceManager.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add coordinate display to Registered Regions section</name>
  <files>apps/ios/trendy/Views/Geofence/GeofenceDebugView.swift</files>
  <action>
Update the "Registered Regions" section (lines 148-190) to display coordinates and radius:

1. Change the iteration from using `monitoredRegionIdentifiers` (array of strings) to using `monitoredRegions` (Set of CLRegion).

2. For each region, cast to CLCircularRegion to access:
   - `center.latitude` and `center.longitude`
   - `radius` (in meters)

3. Update the VStack content for each region row to include:
   - Geofence name (existing - from matched Geofence model)
   - Region identifier (existing)
   - NEW: Coordinates line showing latitude/longitude formatted to 4 decimal places
   - NEW: Radius in meters

Example format for the coordinate text:
```swift
Text("\(String(format: "%.4f", circularRegion.center.latitude)), \(String(format: "%.4f", circularRegion.center.longitude))")
    .font(.caption2)
    .foregroundStyle(.secondary)

Text("Radius: \(Int(circularRegion.radius))m")
    .font(.caption2)
    .foregroundStyle(.secondary)
```

4. Sort the regions by identifier for consistent display order (since Set has no inherent order).

5. Keep existing logic for:
   - Matching regions to Geofence models by identifier
   - Showing green checkmark for matched, orange for orphaned
   - "Unknown Region" label for unmatched regions
  </action>
  <verify>
Build the iOS app in Xcode (Cmd+B). Open the app on simulator, navigate to Settings > Geofences > Debug Status. Verify the "Registered Regions" section shows coordinates and radius for each region.
  </verify>
  <done>
Each registered region row displays:
1. Geofence name (or "Unknown Region")
2. Region identifier
3. Latitude and longitude (e.g., "37.3318, -122.0312")
4. Radius in meters (e.g., "Radius: 100m")
  </done>
</task>

</tasks>

<verification>
1. Build succeeds without errors or warnings
2. GeofenceDebugView displays coordinates for all registered regions
3. Coordinates match actual geofence locations (compare with geofence detail view)
4. Radius values are displayed correctly in meters
</verification>

<success_criteria>
- UAT Test 2 passes: "Registered Regions section shows region identifier AND coordinates"
- User can see latitude, longitude, and radius for each iOS-registered region
- No regressions to existing debug view functionality
</success_criteria>

<output>
After completion, create `.planning/phases/03-geofence-reliability/03-04-SUMMARY.md`
</output>
