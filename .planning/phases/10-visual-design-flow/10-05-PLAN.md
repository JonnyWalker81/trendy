---
phase: 10-visual-design-flow
plan: 05
type: execute
wave: 4
depends_on: ["10-01", "10-04"]
files_modified:
  - apps/ios/trendy/Views/Onboarding/OnboardingFinishView.swift
autonomous: false

must_haves:
  truths:
    - "Confetti celebration plays when finish screen appears"
    - "Celebration includes multiple colors and haptic feedback"
    - "All visual polish requirements verified working end-to-end"
  artifacts:
    - path: "apps/ios/trendy/Views/Onboarding/OnboardingFinishView.swift"
      provides: "Finish screen with confetti celebration"
      contains: "ConfettiSwiftUI"
  key_links:
    - from: "OnboardingFinishView"
      to: "confettiCannon"
      via: "ConfettiSwiftUI modifier"
      pattern: "\\.confettiCannon\\("
---

<objective>
Add celebration animation to finish screen and verify complete onboarding flow.

Purpose: The finish screen is the payoff moment - user completed onboarding. A confetti celebration makes this moment delightful and memorable. This plan addresses DESIGN-06 (celebration animation) and includes visual verification of the entire flow.

Output: Updated OnboardingFinishView with ConfettiSwiftUI celebration animation, verified end-to-end onboarding experience.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-visual-design-flow/10-CONTEXT.md
@.planning/phases/10-visual-design-flow/10-RESEARCH.md
@.planning/phases/10-visual-design-flow/10-01-SUMMARY.md
@.planning/phases/10-visual-design-flow/10-04-SUMMARY.md

# File being modified
@apps/ios/trendy/Views/Onboarding/OnboardingFinishView.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Confetti Celebration to OnboardingFinishView</name>
  <files>apps/ios/trendy/Views/Onboarding/OnboardingFinishView.swift</files>
  <action>
Update OnboardingFinishView to include ConfettiSwiftUI celebration animation.

**Changes:**

1. Add import at top:
   ```swift
   import ConfettiSwiftUI
   ```

2. Add confetti trigger state:
   ```swift
   @State private var confettiTrigger = 0
   ```

3. Add OnboardingProgressBar at top of VStack:
   ```swift
   OnboardingProgressBar(progress: 1.0)  // 100% complete
       .padding(.horizontal, 24)
       .padding(.top, 8)
   ```

4. Add .confettiCannon modifier to the main VStack (after .background):
   ```swift
   .confettiCannon(
       trigger: $confettiTrigger,
       num: 50,
       colors: [.dsChart1, .dsChart2, .dsChart3, .dsChart4, .dsPrimary],
       confettiSize: 10,
       radius: 300,
       hapticFeedback: true
   )
   ```

   NOTE: If dsChart colors don't exist, use:
   ```swift
   colors: [.red, .orange, .yellow, .green, .blue, .purple]
   ```

5. Update onAppear to trigger confetti:
   ```swift
   .onAppear {
       // Trigger animations
       DispatchQueue.main.asyncAfter(deadline: .now() + 0.1) {
           showCheckmark = true
       }
       DispatchQueue.main.asyncAfter(deadline: .now() + 0.3) {
           showContent = true
       }
       // Trigger confetti after checkmark animation
       DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) {
           confettiTrigger += 1
       }
   }
   ```

6. Update the success animation area (ZStack with checkmark):
   - Keep existing animation
   - Consider adding OnboardingHeroView instead of the manual Circle/checkmark
   - Or keep the custom checkmark animation but add subtle glow

7. Update the "You're all set!" text styling to match hero pattern:
   - Larger font if desired
   - Keep existing content but ensure consistency with other screens

Keep all existing functionality:
- SummaryCard for created event type
- "Go to Dashboard" button that calls viewModel.advanceToNextStep()
- All state variables for animations

The celebration should feel premium but not overwhelming - 50 confetti pieces for ~2 seconds with haptic feedback.
  </action>
  <verify>
1. File compiles without errors
2. Build succeeds: `cd apps/ios && xcodebuild -scheme trendy -destination 'platform=iOS Simulator,name=iPhone 16 Pro' build 2>&1 | grep -E "(error:|BUILD)"`
3. import ConfettiSwiftUI present
4. confettiCannon modifier applied
  </verify>
  <done>OnboardingFinishView shows confetti celebration with haptic feedback on appear</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete visual redesign of onboarding flow with:
    - Hero layouts on all screens
    - Progress bar showing completion status
    - Spring-animated transitions between steps
    - Individual permission priming screens
    - Confetti celebration on finish
    - Polished loading view
  </what-built>
  <how-to-verify>
Test the complete onboarding flow on iOS Simulator or device:

1. **Fresh Start:** Delete app data or reinstall to start fresh onboarding

2. **Welcome Screen:**
   - [ ] Progress bar visible at top (should show ~0%)
   - [ ] Hero area with gradient and app icon
   - [ ] "Track anything. See patterns." headline
   - [ ] Feature highlights below
   - [ ] "Get Started" button at bottom
   - [ ] Tap "Get Started" - should slide left with spring animation

3. **Auth Screen:**
   - [ ] Progress bar advanced (~17%)
   - [ ] Hero area with person icon
   - [ ] Form fields work correctly
   - [ ] Sign up/sign in toggle works
   - [ ] Complete auth (sign up or sign in)
   - [ ] Transition animates smoothly to next screen

4. **Create Event Type Screen:**
   - [ ] Progress bar at ~40%
   - [ ] Templates display correctly
   - [ ] Select a template or create custom
   - [ ] Transition animates to next screen

5. **Log First Event Screen:**
   - [ ] Progress bar at ~60%
   - [ ] Event logging works
   - [ ] Transition animates to permissions

6. **Permission Priming Screens:**
   - [ ] First permission (Notifications) shows full-screen priming
   - [ ] Hero with bell icon and orange/red gradient
   - [ ] Benefit bullets visible
   - [ ] "Enable Notifications" button visible
   - [ ] "Skip for now" text link visible (subtle)
   - [ ] Tap Skip - explanation text appears briefly, then advances
   - [ ] Location priming screen appears (blue/purple gradient)
   - [ ] HealthKit priming screen appears (pink/red gradient)
   - [ ] Each transition animates with spring
   - [ ] Progress bar advances through permissions

7. **Finish Screen:**
   - [ ] Progress bar at 100%
   - [ ] Confetti fires automatically!
   - [ ] Haptic feedback felt (on device)
   - [ ] Checkmark animation plays
   - [ ] "You're all set!" text appears
   - [ ] Summary card shows created event type
   - [ ] "Go to Dashboard" button works

8. **Overall Polish:**
   - [ ] No instant cuts - all transitions animate
   - [ ] Spring animations feel bouncy/iOS-native
   - [ ] Colors consistent throughout (design system colors)
   - [ ] Dark mode works correctly (if testing)
   - [ ] Light mode works correctly (if testing)

**Report any issues with:**
- Specific screen name
- What's wrong (missing element, broken animation, etc.)
- Screenshot if possible
  </how-to-verify>
  <resume-signal>Type "approved" to complete phase, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
After all tasks:
1. Project builds without errors
2. ConfettiSwiftUI integrated into OnboardingFinishView
3. Confetti fires on finish screen appear
4. Haptic feedback accompanies confetti
5. All visual requirements verified by human tester
</verification>

<success_criteria>
1. `xcodebuild build` succeeds
2. Confetti animation plays on finish screen
3. Human verification confirms:
   - Progress bar visible throughout flow
   - Hero layouts on welcome, auth, permissions screens
   - Spring transitions between all steps
   - Individual permission priming screens work
   - Skip flow shows explanation
   - Celebration animation delightful
4. All 10 Phase 10 requirements addressed (DESIGN-01 through DESIGN-06, FLOW-01 through FLOW-04)
</success_criteria>

<output>
After completion, create `.planning/phases/10-visual-design-flow/10-05-SUMMARY.md`
</output>
